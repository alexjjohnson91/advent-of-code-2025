package day02

import (
	"log"
	"strconv"
	"strings"
)

type InputRange struct {
	Start 	int64
	End 		int64
}

func Part1(input string) int64 {
	inputRanges := parseRanges(input)
	var summedInvalidIds int64 = 0

	for _, r := range inputRanges {
		log.Printf("Range %v\n", r)
		for i := r.Start; i <= r.End; i++ {
			id := strconv.FormatInt(i, 10)
			start, end := splitInHalf(id)

			if start == end {
				log.Printf("invalid id: %v\n", id)
				summedInvalidIds += i
			} 
		}
	}

	return summedInvalidIds
}

func Part2(input string) int {
	// TODO
	return 0
}

func parseRanges(input string) []InputRange {
	tokens := strings.Split(input, ",")

	ranges := make([]InputRange, 0, len(tokens))

	for _, t := range tokens {
		parts := strings.Split(t, "-")

		start, startErr := strconv.Atoi(parts[0])
		end, endErr := strconv.Atoi(parts[1])

		if startErr != nil || endErr != nil {
			continue
		}

		ranges = append(ranges, InputRange{Start: start, End: end})
	}

	return ranges
}

func splitInHalf(s string) (string, string) {
	r := []rune(s)
	mid := len(r) / 2
	return string(r[:mid]), string(r[mid:])
}
